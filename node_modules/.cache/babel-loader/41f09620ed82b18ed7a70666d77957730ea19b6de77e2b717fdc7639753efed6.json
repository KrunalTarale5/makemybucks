{"ast":null,"code":"import Table from'@components/Table';import{PoppinsTypography}from'@components/Typography';import{useGetSettlementVendorApi,uploadVendorDisbusmentExcelApi}from'@hooks/admin-settlement';import{Button,Stack,useTheme,Dialog,DialogContent,DialogTitle,LinearProgress}from'@mui/material';import{memo,useRef,useState}from'react';import moment from'moment';import{useSnackbar}from'@components/Snackbar';import axios from'axios';import IconFinder from'@components/Icon';import Uploader from'@components/Uploader';import{LoadingButton}from'@mui/lab';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const VendorTab=()=>{var _GetSettlementVendorR,_GetSettlementVendorR2;const theme=useTheme();const searchInputRef=useRef(null);const[pageRequest,setPageRequest]=useState({page:1,size:10});const[sortRequest,setSortRequest]=useState({});const GetSettlementVendorResponse=useGetSettlementVendorApi();const handlePage=page=>{setPageRequest({...pageRequest,page});};const[openUploadDialog,setOpenUploadDialog]=useState(false);const rows=(_GetSettlementVendorR=(_GetSettlementVendorR2=GetSettlementVendorResponse.data)===null||_GetSettlementVendorR2===void 0?void 0:_GetSettlementVendorR2.data.data.transaction_data)!==null&&_GetSettlementVendorR!==void 0?_GetSettlementVendorR:[];// useEffect(() => {\n// \twindow.location.reload();\n// }, [openUploadDialog]);\nconst columns=[{field:'SL No',renderHeader:()=>\"Date\",renderCell:_ref=>{let{row}=_ref;return moment(row.Date).format('DD MMM YY');},tableCellProps:{sx:{width:600}},tableCellTypographySx:{paddingLeft:theme.spacing(1)},tableHeaderProps:{sx:{width:600}}},{field:'action',renderHeader:()=>\"Total Amount (\\u20B9)\",renderCell:_ref2=>{let{row}=_ref2;return row.Total_amount;},tableCellProps:{sx:{width:600}},tableHeaderProps:{sx:{width:600}},sortable:true},{field:'Settlement Type',renderHeader:()=>'Settlement Type',renderCell:_ref3=>{let{row}=_ref3;return row.settlement_status;},sortable:true},{field:'Number of vendors',renderHeader:()=>'Number of vendors',renderCell:_ref4=>{let{row}=_ref4;return row.Number_of_vendors;},sortable:true}];return/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:'inherit',children:[/*#__PURE__*/_jsx(Stack,{alignSelf:'flex-end',children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>setOpenUploadDialog(true),sx:{height:40,width:144},children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"caption\",children:\"Upload\"})})}),/*#__PURE__*/_jsx(Table,{rows:rows,columns:columns,rowId:row=>row.id,tableProps:{size:'small',stickyHeader:false},tableRowProps:{hover:true},onSortChange:sort=>{setSortRequest({sort_by:sort===null||sort===void 0?void 0:sort.field,order:sort===null||sort===void 0?void 0:sort.order});},loading:GetSettlementVendorResponse.isLoading}),/*#__PURE__*/_jsx(UploadExcelDialog,{open:openUploadDialog,handleClose:()=>setOpenUploadDialog(false)})]});};export default/*#__PURE__*/memo(VendorTab);const UploadExcelDialog=/*#__PURE__*/memo(props=>{const theme=useTheme();const{showSnackbar,hideSnackbar}=useSnackbar();const[file,setFile]=useState(null);const[progress,setProgress]=useState(0);const[isSucessful,setIsSucessful]=useState(false);const onUploadClick=()=>{axios.request({...uploadVendorDisbusmentExcelApi(file),onUploadProgress:progress=>{const{loaded,total}=progress;const percentageProgress=Math.floor(loaded/total*100);setProgress(percentageProgress);}}).then(response=>{var _response$data;setProgress(0);setIsSucessful(true);showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});}).catch(error=>{var _error$response,_error$response$data;setIsSucessful(false);setProgress(0);showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});};return/*#__PURE__*/_jsxs(Dialog,{onClose:props.handleClose,open:props.open,maxWidth:\"md\",sx:{'.MuiPaper-root':{minWidth:507}},children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{padding:4,paddingBottom:3},children:/*#__PURE__*/_jsx(PoppinsTypography,{fontSize:20,fontWeight:600,textAlign:'center',sx:{color:theme.palette.common.primaryGreyText},children:isSucessful?'Uploaded Successfully !':progress!==0&&file!==null?'Uploading':\"Upload excel\"})}),/*#__PURE__*/_jsxs(DialogContent,{sx:{display:'flex',flexDirection:'column',gap:6,padding:4,alignItems:'center'},children:[file!==null&&progress!==0?/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:1,alignItems:'center',children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"UploadFile\"}),/*#__PURE__*/_jsx(PoppinsTypography,{children:file[0].name}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progress,sx:{minWidth:200,height:8,backgroundColor:'#DFE3ED',borderRadius:\"8px\",'.MuiLinearProgress-bar':{backgroundColor:'#5DC5FF'}}})]}):isSucessful?/*#__PURE__*/_jsx(IconFinder,{iconName:\"Checked\",iconProps:{fill:theme.palette.success.main,height:40,width:40}}):/*#__PURE__*/_jsxs(Uploader,{fieldName:\"drag\",acceptFiles:\".xlsx\",sx:{placeContent:'flex-end',height:138,width:359,borderWidth:1,borderStyle:'dashed',borderColor:'#8A92A6',borderRadius:\"12px\",justifyContent:'center',alignItems:'center',flexDirection:'column'},onChange:e=>{var _e$target;setFile((_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.files);},file:'',children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"UploadFile\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle2\",sx:{color:theme.palette.common.secondaryGreyText,paddingTop:1},children:\"Drag a file here\"}),/*#__PURE__*/_jsxs(PoppinsTypography,{variant:\"subtitle2\",sx:{color:theme.palette.common.secondaryGreyText,display:'flex'},children:[\"or\",/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle2\",sx:{color:'#18ACFF',textDecoration:'underline',paddingX:0.5},children:\"browse\"}),\"a file to upload\"]})]}),/*#__PURE__*/_jsxs(Stack,{gap:1,flexDirection:'row',children:[/*#__PURE__*/_jsx(LoadingButton,{variant:\"text\",size:\"large\",sx:{minWidth:166,height:46},onClick:props.handleClose,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",fontSize:20,sx:{color:theme.palette.common.primaryGreyText},children:\"Cancel\"})}),/*#__PURE__*/_jsx(LoadingButton,{variant:\"contained\",size:\"large\",sx:{minWidth:166,height:46},onClick:onUploadClick,disabled:file===null||progress!==0,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",fontSize:20,children:\"Upload File\"})})]})]})]});});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}