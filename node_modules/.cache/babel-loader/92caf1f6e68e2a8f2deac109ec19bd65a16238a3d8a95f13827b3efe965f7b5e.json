{"ast":null,"code":"import{AdminCards}from'@components/Cards';import IconFinder from'@components/Icon';import Table from'@components/Table';import{IconButton,Stack,TextField,useTheme}from'@mui/material';import{memo,useRef,useState}from'react';import Pagination from'@components/Pagination';import{useChangeRestaurantStatusApi,useGetRestaurentsApi,useGetRestaurentsCountApi}from'@hooks/admin-restaurant-management';import{useAlertDialog}from'@components/AlertDialog';import{useNavigate}from'react-router-dom';import{useRestaurantStatus}from'@hooks/common';import{PoppinsTypography}from'@components/Typography';import{useSnackbar}from'@components/Snackbar';import{BannerInformation,useBannerInfo}from'@hooks/admin-banner-info';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const RestaurantManagement=()=>{var _searchInputRef$curre,_GetRestaurentsApi$da,_GetRestaurentsApi$da2,_GetRestaurentsCountA,_GetRestaurentsCountA2,_GetRestaurentsCountA3,_GetRestaurentsCountA4,_GetRestaurentsCountA5,_GetRestaurentsCountA6,_GetRestaurentsCountA7,_GetRestaurentsCountA8,_GetRestaurentsCountA9,_GetRestaurentsCountA10,_GetRestaurentsCountA11,_GetRestaurentsCountA12,_GetRestaurentsApi$da3,_GetRestaurentsApi$da4;useBannerInfo(BannerInformation.restaurantManagement);const navigate=useNavigate();const theme=useTheme();const{showAlertDialog,hideAlertDialog}=useAlertDialog();const{showSnackbar,hideSnackbar}=useSnackbar();const getStatus=useRestaurantStatus();const searchInputRef=useRef(null);const GetRestaurentsCountApi=useGetRestaurentsCountApi();const ChangeRestaurantStatusApi=useChangeRestaurantStatusApi();const[pageRequest,setPageRequest]=useState({page:1,size:10});const[sortRequest,setSortRequest]=useState({});const GetRestaurentsApi=useGetRestaurentsApi({...pageRequest,...sortRequest,search:(_searchInputRef$curre=searchInputRef.current)===null||_searchInputRef$curre===void 0?void 0:_searchInputRef$curre.value});const handleKeyDown=event=>{if(event.key==='Enter'){void GetRestaurentsApi.refetch();}};const handlePage=page=>{setPageRequest({...pageRequest,page});};const onCancelSearch=()=>{var _searchInputRef$curre2,_searchInputRef$curre3;if((_searchInputRef$curre2=searchInputRef.current)!==null&&_searchInputRef$curre2!==void 0&&_searchInputRef$curre2.value||((_searchInputRef$curre3=searchInputRef.current)===null||_searchInputRef$curre3===void 0?void 0:_searchInputRef$curre3.value)!==''){searchInputRef.current.value='';void GetRestaurentsApi.refetch();}};const handleDelete=row=>{showAlertDialog({title:\"\".concat(row.status!=='4'?'De-active':'Active',\" \").concat(row.restaurant_name,\"?\"),content:\"Are your sure ? You want to \".concat(row.status!=='4'?'de-active':'active',\" restaurant.\"),buttons:[{children:'Cancel',variant:'outlined',callback:()=>{hideAlertDialog();}},{children:row.status!=='4'?'Yes, Deactivate':'Yes, Activate',variant:'contained',loading:ChangeRestaurantStatusApi.isLoading,callback:()=>{ChangeRestaurantStatusApi.mutateAsync({request:{restaurant_id:row.restaurant_id,status:row.status!=='4'?'disabled':'active'}}).then(response=>{var _response$data;hideAlertDialog();showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});void GetRestaurentsCountApi.refetch();void GetRestaurentsApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});}}]});};const handleUpdate=id=>{showAlertDialog({title:\"Edit Restaurant Details\",content:'Are your sure you want to edit restaurant Details?',buttons:[{children:'Cancel',variant:'outlined',callback:()=>{hideAlertDialog();}},{children:'Yes, Continue',variant:'contained',callback:()=>{navigate(\"/admin/restaurants/update/\".concat(id));hideAlertDialog();}}]});};const handleBlockClick=value=>{searchInputRef.current.value=value;void GetRestaurentsApi.refetch();};const rows=(_GetRestaurentsApi$da=(_GetRestaurentsApi$da2=GetRestaurentsApi.data)===null||_GetRestaurentsApi$da2===void 0?void 0:_GetRestaurentsApi$da2.data.data)!==null&&_GetRestaurentsApi$da!==void 0?_GetRestaurentsApi$da:[];const columns=[{field:'restaurant_id',renderHeader:()=>'Id',renderCell:_ref=>{let{row}=_ref;return row.restaurant_id;},sortable:true},{field:'restaurant_name',renderHeader:()=>\"Name\",renderCell:_ref2=>{let{row}=_ref2;return row.restaurant_name;},sortable:true},{field:'location',renderHeader:()=>'Location',renderCell:_ref3=>{let{row}=_ref3;return row.location;},sortable:true},{field:'address',renderHeader:()=>\"City\",renderCell:_ref4=>{let{row}=_ref4;return row.address;},sortable:true,tableCellProps:{sx:{maxWidth:150}}},{field:'offer_list',renderHeader:()=>\"Active Offer\",renderCell:_ref5=>{let{row}=_ref5;return row.active_offer?\"\".concat(row.active_offer,\"%\"):'';},tableCellTypographySx:{paddingLeft:theme.spacing(1)}},{field:'qr_assign',renderHeader:()=>\"QR Ass\",renderCell:_ref6=>{let{row}=_ref6;return row.qr_assign;},sortable:true},{field:'status',renderHeader:()=>\"Status\",renderCell:_ref7=>{let{row}=_ref7;const status=getStatus(row.status);return/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:status.sx,children:status.lable});},sortable:true},{field:'action',renderHeader:()=>\"Quick Action\",renderCell:_ref8=>{let{row}=_ref8;return/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:1,children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"OpenEye\",iconProps:{fill:theme.palette.secondary.main,cursor:'pointer',onClick:()=>navigate(\"/admin/restaurants/\".concat(row.restaurant_id))}}),/*#__PURE__*/_jsx(IconButton,{disabled:row.status==='5',sx:{padding:'0px'},children:/*#__PURE__*/_jsx(IconFinder,{iconName:\"DashCircle\",iconProps:{cursor:'pointer',onClick:()=>handleDelete(row)}})}),/*#__PURE__*/_jsx(IconFinder,{iconName:\"Pen\",iconProps:{cursor:'pointer',onClick:()=>handleUpdate(row.restaurant_id)}})]});}}];return/*#__PURE__*/_jsxs(Stack,{gap:1,flexGrow:'inherit',children:[/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:12,children:[/*#__PURE__*/_jsxs(Stack,{gap:2,flexDirection:'row',children:[/*#__PURE__*/_jsx(AdminCards,{heading:\"Total Restaurant\",content:(_GetRestaurentsCountA=(_GetRestaurentsCountA2=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA2===void 0?void 0:_GetRestaurentsCountA2.data.data.added_restaurant_count)!==null&&_GetRestaurentsCountA!==void 0?_GetRestaurentsCountA:0,onClick:()=>handleBlockClick('')}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Currently Active\",content:(_GetRestaurentsCountA3=(_GetRestaurentsCountA4=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA4===void 0?void 0:_GetRestaurentsCountA4.data.data.active_restaurant_count)!==null&&_GetRestaurentsCountA3!==void 0?_GetRestaurentsCountA3:0,sx:{background:'#F5FFF4',borderColor:'#B8E5B6'},onClick:()=>handleBlockClick('active')})]}),/*#__PURE__*/_jsxs(Stack,{gap:2,flexDirection:'row',children:[/*#__PURE__*/_jsx(AdminCards,{heading:\"Settlement Amount\",content:\"\\u20B9\".concat((_GetRestaurentsCountA5=(_GetRestaurentsCountA6=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA6===void 0?void 0:_GetRestaurentsCountA6.data.data.settlement_amount)!==null&&_GetRestaurentsCountA5!==void 0?_GetRestaurentsCountA5:'NA'),sx:{background:'#F0F6FF',borderColor:'#D3E1F5'}}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Investment Amount\",content:\"\\u20B9\".concat((_GetRestaurentsCountA7=(_GetRestaurentsCountA8=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA8===void 0?void 0:_GetRestaurentsCountA8.data.data.total_investment)!==null&&_GetRestaurentsCountA7!==void 0?_GetRestaurentsCountA7:'NA'),sx:{background:'#F0F6FF',borderColor:'#D3E1F5'}})]}),/*#__PURE__*/_jsxs(Stack,{gap:2,flexDirection:'row',children:[/*#__PURE__*/_jsx(AdminCards,{heading:\"Pending Approval\",content:(_GetRestaurentsCountA9=(_GetRestaurentsCountA10=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA10===void 0?void 0:_GetRestaurentsCountA10.data.data.pending_approval_count)!==null&&_GetRestaurentsCountA9!==void 0?_GetRestaurentsCountA9:0,sx:{background:'#FFF7E8',borderColor:'#F6EAD4'},onClick:()=>handleBlockClick('approval pending')}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Pending Activation\",content:(_GetRestaurentsCountA11=(_GetRestaurentsCountA12=GetRestaurentsCountApi.data)===null||_GetRestaurentsCountA12===void 0?void 0:_GetRestaurentsCountA12.data.data.pending_activation_count)!==null&&_GetRestaurentsCountA11!==void 0?_GetRestaurentsCountA11:0,sx:{background:'#FFF7E8',borderColor:'#F6EAD4'},onClick:()=>handleBlockClick('activation pending')})]})]}),/*#__PURE__*/_jsx(Stack,{gap:2,flexDirection:'row',alignSelf:'self-end',children:/*#__PURE__*/_jsx(TextField,{size:\"small\",placeholder:\"Search...\",autoComplete:\"off\",InputProps:{startAdornment:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Search\"}),endAdornment:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{padding:\"4px\"},onClick:onCancelSearch,children:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Cancel\"})})},inputRef:searchInputRef,onKeyDown:handleKeyDown,sx:{'.MuiInputBase-input':{paddingLeft:1},'.MuiOutlinedInput-notchedOutline':{borderColor:'#E9ECEF'}}})}),/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:'inherit',children:[/*#__PURE__*/_jsx(Table,{rows:rows,columns:columns,rowId:row=>row.id,tableProps:{size:'small',stickyHeader:false},tableRowProps:{hover:true},onSortChange:sort=>{setSortRequest({sort_by:sort===null||sort===void 0?void 0:sort.field,order:sort===null||sort===void 0?void 0:sort.order});},loading:GetRestaurentsApi.isLoading}),/*#__PURE__*/_jsx(Pagination,{page:pageRequest.page,size:(_GetRestaurentsApi$da3=GetRestaurentsApi.data)===null||_GetRestaurentsApi$da3===void 0?void 0:_GetRestaurentsApi$da3.data.size,totalPages:(_GetRestaurentsApi$da4=GetRestaurentsApi.data)===null||_GetRestaurentsApi$da4===void 0?void 0:_GetRestaurentsApi$da4.data.pagesTotal,onPageChange:handlePage})]})]});};export default/*#__PURE__*/memo(RestaurantManagement);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}