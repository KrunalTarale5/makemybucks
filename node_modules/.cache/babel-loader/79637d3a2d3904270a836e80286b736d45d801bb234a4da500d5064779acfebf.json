{"ast":null,"code":"import IconFinder from'@components/Icon';import InputField from'@components/InputField';import{PoppinsTypography}from'@components/Typography';import Uploader from'@components/Uploader';import{CreateNotificationFields,useCreateNotificationApi,useGetAllNotificationByIdApi,useGetSelectCategoryListApi,validateCreateNotificationForm}from'@hooks/admin-notifications';import{LoadingButton}from'@mui/lab';import{Stack,useTheme}from'@mui/material';import{memo,useEffect,useState}from'react';import{DemoContainer}from'@mui/x-date-pickers/internals/demo';import{LocalizationProvider}from'@mui/x-date-pickers/LocalizationProvider';import{DatePicker}from'@mui/x-date-pickers/DatePicker';import{AdapterMoment}from'@mui/x-date-pickers/AdapterMoment';import moment from'moment';import{useSnackbar}from'@components/Snackbar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const message_body_types=[{value:'text',label:'Text'},{value:'image',label:'Image'}];const message_types=[{value:'instant',label:'Instant'},{value:'schedule send',label:'Schedule Send'}];const intialFormData={message_img:'',message_title:'',message_info_text:'',message_body_type:message_body_types[0],message_body:'',message_category:'',message_type:message_types[0],hr:'',min:'',ampm:'',ddmm:''};const intialFormError={message_img:'',message_title:'',message_info_text:'',message_body_type:'',message_body:'',message_category:'',message_type:'',hr:'',min:'',ampm:'',ddmm:''};const CreateTab=props=>{var _GetAllNotificationBy,_GetSelectCategoryLis7,_formData$message_bod2,_formData$message_typ3,_formData$message_typ4;const theme=useTheme();const{showSnackbar,hideSnackbar}=useSnackbar();const CreateNotificationApi=useCreateNotificationApi(props.isToUpdate);const GetSelectCategoryListApi=useGetSelectCategoryListApi();const GetAllNotificationByIdApi=useGetAllNotificationByIdApi(props.isToUpdate);const[formData,setFormData]=useState(intialFormData);const[formError,setFormError]=useState(intialFormError);const onChange=(fieldName,value)=>{const _formData={...formData,[fieldName]:value};setFormData(_formData);setFormError({...formError,[fieldName]:CreateNotificationFields(fieldName,_formData)});};const handleClick=()=>{var _formData$message_cat,_formData$message_bod,_formData$message_typ,_formData$message_typ2,_formData$hr,_formData$min,_formData$ampm;const validatation=validateCreateNotificationForm(formData);if(validatation.hasError){setFormError(validatation.errors);return;}CreateNotificationApi.mutateAsync({request:{message_category:(_formData$message_cat=formData.message_category)===null||_formData$message_cat===void 0?void 0:_formData$message_cat.value,message_info_text:formData.message_info_text,message_title:formData.message_title,message_body_type:(_formData$message_bod=formData.message_body_type)===null||_formData$message_bod===void 0?void 0:_formData$message_bod.value,message_type:(_formData$message_typ=formData.message_type)===null||_formData$message_typ===void 0?void 0:_formData$message_typ.value,...(formData.message_body_type.value==='text'&&{message_body:formData.message_body}),...(formData.message_body_type.value==='image'&&{message_img:formData.message_img}),...(((_formData$message_typ2=formData.message_type)===null||_formData$message_typ2===void 0?void 0:_formData$message_typ2.value)==='schedule send'&&{schedule_time:\"\".concat(formData.ddmm,\" \").concat((_formData$hr=formData.hr)===null||_formData$hr===void 0?void 0:_formData$hr.value,\":\").concat((_formData$min=formData.min)===null||_formData$min===void 0?void 0:_formData$min.value,\" \").concat((_formData$ampm=formData.ampm)===null||_formData$ampm===void 0?void 0:_formData$ampm.value)})}}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});setFormData(intialFormData);}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});};const data=(_GetAllNotificationBy=GetAllNotificationByIdApi.data)===null||_GetAllNotificationBy===void 0?void 0:_GetAllNotificationBy.data.data;useEffect(()=>{if(props.isToUpdate){var _label$value,_GetSelectCategoryLis,_GetSelectCategoryLis2,_GetSelectCategoryLis3,_GetSelectCategoryLis4,_GetSelectCategoryLis5,_GetSelectCategoryLis6,_data$message_info_te,_data$message_title,_message_body_types$f,_message_types$find,_data$message_body,_data$message_img;setFormData({message_category:(_label$value={label:(_GetSelectCategoryLis=(_GetSelectCategoryLis2=GetSelectCategoryListApi.data)===null||_GetSelectCategoryLis2===void 0?void 0:(_GetSelectCategoryLis3=_GetSelectCategoryLis2.data.categoryData.find(c=>c.msg_category_id===(data===null||data===void 0?void 0:data.message_category)))===null||_GetSelectCategoryLis3===void 0?void 0:_GetSelectCategoryLis3.message_category)!==null&&_GetSelectCategoryLis!==void 0?_GetSelectCategoryLis:'',value:(_GetSelectCategoryLis4=(_GetSelectCategoryLis5=GetSelectCategoryListApi.data)===null||_GetSelectCategoryLis5===void 0?void 0:(_GetSelectCategoryLis6=_GetSelectCategoryLis5.data.categoryData.find(c=>c.msg_category_id===(data===null||data===void 0?void 0:data.message_category)))===null||_GetSelectCategoryLis6===void 0?void 0:_GetSelectCategoryLis6.msg_category_id)!==null&&_GetSelectCategoryLis4!==void 0?_GetSelectCategoryLis4:''})!==null&&_label$value!==void 0?_label$value:'',message_info_text:(_data$message_info_te=data===null||data===void 0?void 0:data.message_info_text)!==null&&_data$message_info_te!==void 0?_data$message_info_te:'',message_title:(_data$message_title=data===null||data===void 0?void 0:data.message_title)!==null&&_data$message_title!==void 0?_data$message_title:'',message_body_type:(_message_body_types$f=message_body_types.find(m=>m.value===(data===null||data===void 0?void 0:data.message_body_type)))!==null&&_message_body_types$f!==void 0?_message_body_types$f:'',message_type:(_message_types$find=message_types.find(m=>m.value===(data===null||data===void 0?void 0:data.message_type)))!==null&&_message_types$find!==void 0?_message_types$find:'',message_body:(_data$message_body=data===null||data===void 0?void 0:data.message_body)!==null&&_data$message_body!==void 0?_data$message_body:'',message_img:(_data$message_img=data===null||data===void 0?void 0:data.message_img)!==null&&_data$message_img!==void 0?_data$message_img:'',hr:{label:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).hours()%12):'',value:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).hours()%12):''},min:{label:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).minutes()):'',value:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).minutes()):''},ampm:{label:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).format('A')):'',value:data!==null&&data!==void 0&&data.schedule_time?String(moment(data===null||data===void 0?void 0:data.schedule_time).format('A')):''},ddmm:data!==null&&data!==void 0&&data.schedule_time?moment(data===null||data===void 0?void 0:data.schedule_time).format('MM-DD-YYYY'):''});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[props.isToUpdate,data]);return/*#__PURE__*/_jsxs(Stack,{gap:6,children:[/*#__PURE__*/_jsxs(Stack,{gap:3,children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Create New Notification\"}),/*#__PURE__*/_jsxs(Stack,{gap:1,children:[/*#__PURE__*/_jsx(InputField,{fieldName:'message_category',value:formData.message_category,fieldProps:{placeholder:'Select category',error:Boolean(formError['message_category']),helperText:formError['message_category'],size:'medium',options:(_GetSelectCategoryLis7=GetSelectCategoryListApi.data)===null||_GetSelectCategoryLis7===void 0?void 0:_GetSelectCategoryLis7.data.categoryData.map(o=>({label:String(o.message_category),value:String(o.msg_category_id)})),sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:356},'& .MuiTypography-subtitle1':{color:theme.palette.common.primaryGreyText}}},fieldType:'select',onChange:onChange}),/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:'message_info_text',value:formData.message_info_text,fieldProps:{placeholder:'Information Text',size:'medium',error:Boolean(formError['message_info_text']),helperText:formError['message_info_text'],sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:356}}},onChange:onChange})]})]}),/*#__PURE__*/_jsxs(Stack,{gap:1,children:[/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:'message_title',value:formData.message_title,fieldProps:{placeholder:'Type Heading',size:'medium',error:Boolean(formError['message_title']),helperText:formError['message_title'],sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:356}}},onChange:onChange}),/*#__PURE__*/_jsx(InputField,{fieldName:'message_body_type',value:formData.message_body_type,fieldProps:{placeholder:'Select Body Type',error:Boolean(formError['message_body_type']),helperText:formError['message_body_type'],size:'medium',options:message_body_types,sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:356},'& .MuiTypography-subtitle1':{color:theme.palette.common.primaryGreyText}}},fieldType:'select',onChange:onChange}),((_formData$message_bod2=formData.message_body_type)===null||_formData$message_bod2===void 0?void 0:_formData$message_bod2.value)==='image'?/*#__PURE__*/_jsxs(Uploader,{fieldName:\"message_img\",sx:{flexDirection:'column',alignItems:'center',placeContent:'center',width:356,height:129,borderRadius:'8px',borderStyle:'solid',borderWidth:'1px',borderColor:theme.palette.common.secondaryGreyText},file:formData.message_img,onChange:event=>onChange('message_img',event.target.files),children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"Upload\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Upload image\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"caption\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Max size 300KB\"})]}):/*#__PURE__*/_jsx(InputField,{fieldName:\"message_body\",value:formData.message_body,fieldProps:{placeholder:'Type body text...',multiline:true,maxRows:5,size:'medium',sx:{'& .MuiInputBase-input':{height:\"119px !important\",paddingX:\"14px\",paddingY:\"16px\",fontSize:'18px',color:theme.palette.common.primaryGreyText,fontFamily:'Fira Sans',overflow:'auto'},'& .MuiInputBase-root':{width:356,padding:0,borderRadius:'8px',borderColor:theme.palette.common.secondaryGreyText}},error:Boolean(formError['message_body']),helperText:formError['message_body']},onChange:onChange})]}),/*#__PURE__*/_jsxs(Stack,{gap:1,children:[/*#__PURE__*/_jsx(InputField,{fieldName:'message_type',value:formData.message_type,fieldProps:{placeholder:'Select Send Type',error:Boolean(formError['message_type']),helperText:formError['message_type'],size:'medium',options:message_types,sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:356},'& .MuiTypography-subtitle1':{color:theme.palette.common.primaryGreyText}}},fieldType:'select',onChange:onChange}),((_formData$message_typ3=formData.message_type)===null||_formData$message_typ3===void 0?void 0:_formData$message_typ3.value)==='schedule send'&&/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:4,alignItems:'center'//gap={4}\n,children:[/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterMoment,children:/*#__PURE__*/_jsx(DemoContainer,{components:['DatePicker'],children:/*#__PURE__*/_jsx(DatePicker,{format:\"DD/MM/YYYY\",slotProps:{textField:{placeholder:'DD/MM/YYYY',error:Boolean(formError['ddmm'])//\thelperText: formError['ddmm'],\n/* InputProps: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tendAdornment: <IconFinder iconName={'Calender'} />,\r\n\t\t\t\t\t\t\t\t\t\t\t}, */}},onChange:value=>onChange('ddmm',value===null||value===void 0?void 0:value.format('MM-DD-YYYY')),sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\",width:146},'& .MuiInputBase-input':{height:11,width:150}},value:moment(formData.ddmm)})})}),/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:1,children:[/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:'hr',value:formData.hr,fieldProps:{placeholder:'Hours',size:'medium',error:Boolean(formError['hr']),//\thelperText: formError['hr'],\noptions:Array.from(Array(12).keys()).map(o=>({label:String(o+1),value:String(o+1)})),sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\",minWidth:\"114px\"},'& .MuiInputBase-input':{height:11},'& .MuiAutocomplete-clearIndicator':{display:'none'},'& .MuiAutocomplete-inputRoot':{minWidth:\"114px\"}}},fieldType:'select',onChange:onChange}),/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:'min',value:formData.min,fieldProps:{placeholder:'Min',size:'medium',error:Boolean(formError['min']),//\t\thelperText: formError['min'],\noptions:Array.from(Array(60).keys()).map(o=>({label:String(o),value:String(o)})),sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\",minWidth:\"114px\"},'& .MuiInputBase-input':{height:11},'& .MuiAutocomplete-clearIndicator':{display:'none'},'& .MuiAutocomplete-inputRoot':{minWidth:\"114px\"}}},fieldType:'select',onChange:onChange})]}),/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:'ampm',value:formData.ampm,fieldProps:{placeholder:'AM',size:'medium',error:Boolean(formError['ampm']),//\t\thelperText: formError['ampm'],\noptions:['AM','PM'].map(o=>({label:o,value:o})),sx:{paddingLeft:'10px',width:\"73px\",'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiAutocomplete-clearIndicator':{display:'none'},'& .MuiAutocomplete-inputRoot':{width:\"73px\"}}},fieldType:'select',onChange:onChange})]})]}),/*#__PURE__*/_jsx(LoadingButton,{size:\"large\",variant:\"contained\",color:\"primary\",sx:{width:209,height:51,borderRadius:'8px',marginTop:10},onClick:handleClick,loading:GetSelectCategoryListApi.isLoading,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",children:((_formData$message_typ4=formData.message_type)===null||_formData$message_typ4===void 0?void 0:_formData$message_typ4.value)==='schedule send'?'Save':'Send Now'})})]});};export default/*#__PURE__*/memo(CreateTab);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}