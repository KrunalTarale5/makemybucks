{"ast":null,"code":"import{AdminCards}from'@components/Cards';import IconFinder from'@components/Icon';import Table from'@components/Table';import{IconButton,Stack,TextField,useTheme}from'@mui/material';import{memo,useRef,useState}from'react';import Pagination from'@components/Pagination';import{useAlertDialog}from'@components/AlertDialog';import{useNavigate}from'react-router-dom';import{useOwnerStatus}from'@hooks/common';import{PoppinsTypography}from'@components/Typography';import{useSnackbar}from'@components/Snackbar';import{BannerInformation,useBannerInfo}from'@hooks/admin-banner-info';import{useChangeOwnerStatusApi,useGetOwnerCountApi,useGetOwnersApi}from'@hooks/admin-owner-management';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const OwnersManagement=()=>{var _searchInputRef$curre,_GetOwnersApi$data$da,_GetOwnersApi$data,_GetOwnerCountApi$dat,_GetOwnerCountApi$dat2,_GetOwnerCountApi$dat3,_GetOwnerCountApi$dat4,_GetOwnerCountApi$dat5,_GetOwnerCountApi$dat6,_GetOwnerCountApi$dat7,_GetOwnerCountApi$dat8,_GetOwnersApi$data2,_GetOwnersApi$data3;useBannerInfo(BannerInformation.ownersManagement);const navigate=useNavigate();const theme=useTheme();const{showAlertDialog,hideAlertDialog}=useAlertDialog();const{showSnackbar,hideSnackbar}=useSnackbar();const getStatus=useOwnerStatus();const searchInputRef=useRef(null);const GetOwnerCountApi=useGetOwnerCountApi();const ChangeOwnerStatusApi=useChangeOwnerStatusApi();const[pageRequest,setPageRequest]=useState({page:1,size:10});const[sortRequest,setSortRequest]=useState({});const GetOwnersApi=useGetOwnersApi({...pageRequest,...sortRequest,search:(_searchInputRef$curre=searchInputRef.current)===null||_searchInputRef$curre===void 0?void 0:_searchInputRef$curre.value});const handleKeyDown=event=>{if(event.key==='Enter'){void GetOwnersApi.refetch();}};const handlePage=page=>{setPageRequest({...pageRequest,page});};const onCancelSearch=()=>{var _searchInputRef$curre2,_searchInputRef$curre3;if((_searchInputRef$curre2=searchInputRef.current)!==null&&_searchInputRef$curre2!==void 0&&_searchInputRef$curre2.value||((_searchInputRef$curre3=searchInputRef.current)===null||_searchInputRef$curre3===void 0?void 0:_searchInputRef$curre3.value)!==''){searchInputRef.current.value='';void GetOwnersApi.refetch();}};const handleBlockClick=value=>{searchInputRef.current.value=value;void GetOwnersApi.refetch();};const handleDelete=row=>{showAlertDialog({title:\"\".concat(\"De-active \".concat(row.owner_name)),content:\"Are your sure? You want to \".concat(\"de-active\",\" this user.\"),buttons:[{children:'Cancel',variant:'outlined',callback:()=>{hideAlertDialog();}},{children:'Yes, Deactivate',variant:'contained',callback:()=>{ChangeOwnerStatusApi.mutateAsync({request:{owner_id:row.owner_id,owner_status:'deactivate'}}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});hideAlertDialog();void GetOwnersApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});}}]});};const rows=(_GetOwnersApi$data$da=(_GetOwnersApi$data=GetOwnersApi.data)===null||_GetOwnersApi$data===void 0?void 0:_GetOwnersApi$data.data.data)!==null&&_GetOwnersApi$data$da!==void 0?_GetOwnersApi$data$da:[];const columns=[{field:'owner_id',renderHeader:()=>'Id',renderCell:_ref=>{let{row}=_ref;return row.owner_id;},sortable:true},{field:'owner_name',renderHeader:()=>\"Name\",renderCell:_ref2=>{let{row}=_ref2;return row.owner_name;},sortable:true},{field:'city',renderHeader:()=>'City',renderCell:_ref3=>{let{row}=_ref3;return row.city;},sortable:true},{field:'state',renderHeader:()=>\"State\",renderCell:_ref4=>{let{row}=_ref4;return row.state;},sortable:true,tableCellProps:{sx:{maxWidth:150}}},{field:'agreement_type',renderHeader:()=>\"Type\",renderCell:_ref5=>{let{row}=_ref5;return row.agreement_type;},tableCellTypographySx:{paddingLeft:theme.spacing(1)}},{field:'added_by',renderHeader:()=>\"Added By\",renderCell:_ref6=>{let{row}=_ref6;return row.added_by;},sortable:true},{field:'status',renderHeader:()=>\"Status\",renderCell:_ref7=>{let{row}=_ref7;const status=getStatus(row.owner_status);return/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:status.sx,children:status.lable});},sortable:true},{field:'action',renderHeader:()=>\"Quick Action\",renderCell:_ref8=>{let{row}=_ref8;return/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:1,children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"OpenEye\",iconProps:{fill:theme.palette.secondary.main,cursor:'pointer',onClick:()=>navigate(\"/admin/owners/\".concat(row.owner_id))}}),/*#__PURE__*/_jsx(IconFinder,{iconName:\"DashCircle\",iconProps:{cursor:'pointer',onClick:()=>handleDelete(row)}})]});}}];return/*#__PURE__*/_jsxs(Stack,{gap:1,flexGrow:'inherit',children:[/*#__PURE__*/_jsx(Stack,{flexDirection:'row',gap:12,children:/*#__PURE__*/_jsxs(Stack,{gap:2,flexDirection:'row',children:[/*#__PURE__*/_jsx(AdminCards,{heading:\"Total Contract\",content:(_GetOwnerCountApi$dat=(_GetOwnerCountApi$dat2=GetOwnerCountApi.data)===null||_GetOwnerCountApi$dat2===void 0?void 0:_GetOwnerCountApi$dat2.data.data.total_contract)!==null&&_GetOwnerCountApi$dat!==void 0?_GetOwnerCountApi$dat:0,onClick:()=>handleBlockClick('')}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Currently Active\",content:(_GetOwnerCountApi$dat3=(_GetOwnerCountApi$dat4=GetOwnerCountApi.data)===null||_GetOwnerCountApi$dat4===void 0?void 0:_GetOwnerCountApi$dat4.data.data.active_owner_count)!==null&&_GetOwnerCountApi$dat3!==void 0?_GetOwnerCountApi$dat3:0,sx:{background:'#F5FFF4',borderColor:'#B8E5B6'},onClick:()=>handleBlockClick('approved')}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Pending Approval\",content:(_GetOwnerCountApi$dat5=(_GetOwnerCountApi$dat6=GetOwnerCountApi.data)===null||_GetOwnerCountApi$dat6===void 0?void 0:_GetOwnerCountApi$dat6.data.data.pending_approval_count)!==null&&_GetOwnerCountApi$dat5!==void 0?_GetOwnerCountApi$dat5:0,sx:{background:'#FFF7E8',borderColor:'#F6EAD4'},onClick:()=>handleBlockClick('pending approval')}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Upcoming Renewal\",content:(_GetOwnerCountApi$dat7=(_GetOwnerCountApi$dat8=GetOwnerCountApi.data)===null||_GetOwnerCountApi$dat8===void 0?void 0:_GetOwnerCountApi$dat8.data.data.upcoming_renewal)!==null&&_GetOwnerCountApi$dat7!==void 0?_GetOwnerCountApi$dat7:0,sx:{background:'#F0F6FF',borderColor:'#D3E1F5'},onClick:()=>handleBlockClick('upcoming renewal')})]})}),/*#__PURE__*/_jsx(Stack,{gap:2,flexDirection:'row',alignSelf:'self-end',children:/*#__PURE__*/_jsx(TextField,{size:\"small\",placeholder:\"Search...\",autoComplete:\"off\",InputProps:{startAdornment:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Search\"}),endAdornment:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{padding:\"4px\"},onClick:onCancelSearch,children:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Cancel\"})})},inputRef:searchInputRef,onKeyDown:handleKeyDown,sx:{'.MuiInputBase-input':{paddingLeft:1},'.MuiOutlinedInput-notchedOutline':{borderColor:'#E9ECEF'}}})}),/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:'inherit',children:[/*#__PURE__*/_jsx(Table,{rows:rows,columns:columns,rowId:row=>row.id,tableProps:{size:'small',stickyHeader:false},tableRowProps:{hover:true},onSortChange:sort=>{setSortRequest({sort_by:sort===null||sort===void 0?void 0:sort.field,order:sort===null||sort===void 0?void 0:sort.order});},loading:GetOwnersApi.isLoading}),/*#__PURE__*/_jsx(Pagination,{page:pageRequest.page,size:(_GetOwnersApi$data2=GetOwnersApi.data)===null||_GetOwnersApi$data2===void 0?void 0:_GetOwnersApi$data2.data.size,totalPages:(_GetOwnersApi$data3=GetOwnersApi.data)===null||_GetOwnersApi$data3===void 0?void 0:_GetOwnersApi$data3.data.pagesTotal,onPageChange:handlePage})]})]});};export default/*#__PURE__*/memo(OwnersManagement);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}