{"ast":null,"code":"import{useAlertDialog}from'@components/AlertDialog';import DetailsTable from'@components/DetailsTable';import IconFinder from'@components/Icon';import InputField from'@components/InputField';import{useSnackbar}from'@components/Snackbar';import Table from'@components/Table';import{PoppinsTypography}from'@components/Typography';import{useGetPaybackApi,useGetProfitApi,useUpdateProfitApi}from'@hooks/admin-transation';import{Box,Button,Stack,useTheme}from'@mui/material';import moment from'moment';import{memo,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const PaybackTab=()=>{var _GetPaybackApi$data$d,_GetPaybackApi$data,_GetProfitApi$data2,_GetProfitApi$data3;const theme=useTheme();const{showAlertDialog,hideAlertDialog}=useAlertDialog();const{showSnackbar,hideSnackbar}=useSnackbar();const GetProfitApi=useGetProfitApi();const UpdateProfitApi=useUpdateProfitApi();const GetPaybackApi=useGetPaybackApi();const[profit,setProfit]=useState('');const makeDate=new Date(new Date().setMonth(new Date().getMonth()-1));const previousMonth=moment(makeDate.toDateString()).format('MMMM');console.warn(previousMonth);const rows=(_GetPaybackApi$data$d=(_GetPaybackApi$data=GetPaybackApi.data)===null||_GetPaybackApi$data===void 0?void 0:_GetPaybackApi$data.data.data.payback_data)!==null&&_GetPaybackApi$data$d!==void 0?_GetPaybackApi$data$d:[];const columns=[{field:'month_year',renderHeader:()=>\"Month\",renderCell:_ref=>{let{row}=_ref;return row.month_year;},tableCellProps:{sx:{width:200}},tableCellTypographySx:{paddingLeft:theme.spacing(1)},tableHeaderProps:{sx:{width:200}}},{field:'total_disbursable_amount',renderHeader:()=>\"Total Disbursable Amount (\\u20B9)\",renderCell:_ref2=>{let{row}=_ref2;return row.total_disbursable_amount;},tableCellProps:{sx:{width:350,textAlign:'center'}},tableHeaderProps:{sx:{width:350,flexDirection:'column',textAlign:'-webkit-center'}}},{field:'payback_to_user',renderHeader:()=>'Payback Disbursed to User',renderCell:_ref3=>{let{row}=_ref3;return row.payback_to_user;},tableCellProps:{sx:{width:350,textAlign:'center'}},tableHeaderProps:{sx:{width:350,flexDirection:'column',textAlign:'-webkit-center'}}},{field:'payback_to_restaurant',renderHeader:()=>\"Payback Disbursed to Restaurant (\\u20B9)\",renderCell:_ref4=>{let{row}=_ref4;return row.payback_to_restaurant;},tableCellProps:{sx:{width:400,textAlign:'center'}},tableHeaderProps:{sx:{width:400,flexDirection:'column',textAlign:'-webkit-center'}}}];const onSubmit=()=>{showAlertDialog({title:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:3,children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"Warning\",iconProps:{style:{marginTop:\"8px\"}}}),/*#__PURE__*/_jsxs(Stack,{children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h4\",sx:{color:theme.palette.common.primaryGreyText},children:\"Profit Amount Confirmation\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:'#929292'},children:\"Your are entering the the profit amount. Make sure you have entered correct amount.\"})]})]}),content:/*#__PURE__*/_jsx(Box,{gap:2,sx:{textAlign:'-webkit-center','& table':{borderCollapse:'separate',borderSpacing:\"0 4px\"},'& .tdValue':{paddingLeft:4},'& tr':{verticalAlign:'top'}},children:/*#__PURE__*/_jsx(DetailsTable,{data:[{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h6\",paddingRight:4,sx:{color:theme.palette.common.primaryGreyText},fontWeight:400,children:\"Profit Amount (\\u20B9)\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h6\",paddingRight:4,sx:{color:theme.palette.common.primaryGreyText},fontWeight:600,children:profit}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',gap:2,children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h6\",sx:{color:theme.palette.common.primaryGreyText},fontWeight:400,children:previousMonth}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h6\",sx:{color:theme.palette.common.primaryGreyText},fontWeight:600}),showWhen:true}]})}),buttons:[{children:'Cancel',variant:'outlined',callback:()=>{hideAlertDialog();}},{children:'Confirm',variant:'contained',callback:()=>{UpdateProfitApi.mutateAsync({request:{profit_for_month:profit}}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});hideAlertDialog();void GetProfitApi.refetch();void GetPaybackApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});}}]});};useEffect(()=>{var _GetProfitApi$data$da,_GetProfitApi$data,_GetProfitApi$data$da2;setProfit((_GetProfitApi$data$da=(_GetProfitApi$data=GetProfitApi.data)===null||_GetProfitApi$data===void 0?void 0:(_GetProfitApi$data$da2=_GetProfitApi$data.data)===null||_GetProfitApi$data$da2===void 0?void 0:_GetProfitApi$data$da2.profit_for_month)!==null&&_GetProfitApi$data$da!==void 0?_GetProfitApi$data$da:'');// eslint-disable-next-line react-hooks/exhaustive-deps\n},[GetProfitApi.dataUpdatedAt]);return/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:'inherit',children:[/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:2,alignItems:'flex-end',children:[/*#__PURE__*/_jsx(InputField,{fieldName:\"input\",fieldProps:{label:'Profit for Month',fullWidth:true,sx:{width:465,gap:0},disabled:(_GetProfitApi$data2=GetProfitApi.data)===null||_GetProfitApi$data2===void 0?void 0:_GetProfitApi$data2.data.clickable},onChange:(_,v)=>setProfit(v),value:profit}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"large\",sx:{height:40},onClick:onSubmit,disabled:(_GetProfitApi$data3=GetProfitApi.data)===null||_GetProfitApi$data3===void 0?void 0:_GetProfitApi$data3.data.clickable,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"caption\",children:\"Submit\"})})]}),/*#__PURE__*/_jsx(Table,{rows:rows,columns:columns,rowId:row=>row.id,tableProps:{size:'small',stickyHeader:false},tableRowProps:{hover:true},loading:GetPaybackApi.isLoading,sx:{paddingTop:5}})]});};export default/*#__PURE__*/memo(PaybackTab);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}