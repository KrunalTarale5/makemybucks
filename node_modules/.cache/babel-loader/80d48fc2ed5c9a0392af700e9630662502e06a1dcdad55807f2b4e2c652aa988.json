{"ast":null,"code":"import{useSetDocumentStatusApi,useUpdateRestaurantDetailsApi}from'@hooks/admin-restaurant-management';import{validateAddDocunemtFields}from'@hooks/sub-admin-add-restaurant';import{LoadingButton}from'@mui/lab';import{Dialog,DialogTitle,DialogContent,Stack,useTheme,IconButton}from'@mui/material';import{useEffect,useState}from'react';import DetailsTable from'./DetailsTable';import InputField from'./InputField';import{useSnackbar}from'./Snackbar';import{PoppinsTypography}from'./Typography';import{useUpdateKYCStatusApi}from'@hooks/admin-user-management';import{useUpdateOwnerDocumentStatusApi}from'@hooks/admin-owner-management';import{useGetRejectedReasonApi}from'@hooks/admin-master-list';import IconFinder from'./Icon';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const AcceptRejectDocumentsDialog=props=>{var _GetRejectedReasonApi;const theme=useTheme();const{showSnackbar,hideSnackbar}=useSnackbar();const SetDocumentStatusApi=useSetDocumentStatusApi();const UpdateKYCStatusApi=useUpdateKYCStatusApi();const UpdateOwnerDocumentStatusApi=useUpdateOwnerDocumentStatusApi();const GetRejectedReasonApi=useGetRejectedReasonApi();const[showRejectReasons,setShowRejectReasons]=useState(false);const[selectedRejectReasons,setSelectedRejectReasons]=useState();const getType=type=>{switch(type){case'PAN':return'pan';case'GST Number':return'gst';case'FSSAI Licence':return'fssai';case'Bank Details':return'bank';case'Registration Certificate':return'registration_certificate';default:return'';}};const handelOnAccept=()=>{if(props.useApi==='restaurent'){SetDocumentStatusApi.mutateAsync({request:{restaurant_id:props.id,status:'accept',type:getType(props.type),reject_reason:''}}).then(response=>{var _response$data,_props$refetch,_props$handleClose;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});(_props$refetch=props.refetch)===null||_props$refetch===void 0?void 0:_props$refetch.call(props);(_props$handleClose=props.handleClose)===null||_props$handleClose===void 0?void 0:_props$handleClose.call(props);}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});return;}if(props.useApi==='user'){UpdateKYCStatusApi.mutateAsync({request:{user_id:props.id,KYC_Approval_status:'Verified'}}).then(response=>{var _response$data2,_props$refetch2,_props$handleClose2;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.message,onCancel:()=>hideSnackbar()});(_props$refetch2=props.refetch)===null||_props$refetch2===void 0?void 0:_props$refetch2.call(props);(_props$handleClose2=props.handleClose)===null||_props$handleClose2===void 0?void 0:_props$handleClose2.call(props);}).catch(error=>{var _error$response2,_error$response2$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message,onCancel:()=>hideSnackbar()});});return;}if(props.useApi==='owner'){UpdateOwnerDocumentStatusApi.mutateAsync({request:{owner_id:props.id,owner_status:'accept',type:getType(props.type),reject_reason:''}}).then(response=>{var _response$data3,_props$refetch3,_props$handleClose3;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.message,onCancel:()=>hideSnackbar()});(_props$refetch3=props.refetch)===null||_props$refetch3===void 0?void 0:_props$refetch3.call(props);(_props$handleClose3=props.handleClose)===null||_props$handleClose3===void 0?void 0:_props$handleClose3.call(props);}).catch(error=>{var _error$response3,_error$response3$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message,onCancel:()=>hideSnackbar()});});return;}};const handelOnReject=()=>{if(props.useApi==='user'){UpdateKYCStatusApi.mutateAsync({request:{user_id:props.id,KYC_Approval_status:'Pending'}}).then(response=>{var _response$data4,_props$refetch4,_props$handleClose4;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data4=response.data)===null||_response$data4===void 0?void 0:_response$data4.message,onCancel:()=>hideSnackbar()});(_props$refetch4=props.refetch)===null||_props$refetch4===void 0?void 0:_props$refetch4.call(props);(_props$handleClose4=props.handleClose)===null||_props$handleClose4===void 0?void 0:_props$handleClose4.call(props);}).catch(error=>{var _error$response4,_error$response4$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message,onCancel:()=>hideSnackbar()});});return;}if(props.useApi==='owner'||props.useApi==='restaurent'){setShowRejectReasons(true);return;}};const rejectDocument=()=>{if(props.useApi==='restaurent'){SetDocumentStatusApi.mutateAsync({request:{restaurant_id:props.id,status:'reject',type:getType(props===null||props===void 0?void 0:props.type),reject_reason:String(selectedRejectReasons===null||selectedRejectReasons===void 0?void 0:selectedRejectReasons.value)}}).then(response=>{var _response$data5,_props$refetch5,_props$handleClose5;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data5=response.data)===null||_response$data5===void 0?void 0:_response$data5.message,onCancel:()=>hideSnackbar()});(_props$refetch5=props.refetch)===null||_props$refetch5===void 0?void 0:_props$refetch5.call(props);(_props$handleClose5=props.handleClose)===null||_props$handleClose5===void 0?void 0:_props$handleClose5.call(props);}).catch(error=>{var _error$response5,_error$response5$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.message,onCancel:()=>hideSnackbar()});});return;}if(props.useApi==='owner'){UpdateOwnerDocumentStatusApi.mutateAsync({request:{owner_id:props.id,owner_status:'reject',type:getType(props.type),reject_reason:String(selectedRejectReasons===null||selectedRejectReasons===void 0?void 0:selectedRejectReasons.value)}}).then(response=>{var _response$data6,_props$refetch6,_props$handleClose6;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data6=response.data)===null||_response$data6===void 0?void 0:_response$data6.message,onCancel:()=>hideSnackbar()});(_props$refetch6=props.refetch)===null||_props$refetch6===void 0?void 0:_props$refetch6.call(props);(_props$handleClose6=props.handleClose)===null||_props$handleClose6===void 0?void 0:_props$handleClose6.call(props);}).catch(error=>{var _error$response6,_error$response6$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.message,onCancel:()=>hideSnackbar()});});return;}};useEffect(()=>{if(!props.heading){setShowRejectReasons(false);setSelectedRejectReasons(undefined);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[props.heading]);return/*#__PURE__*/_jsxs(Dialog,{onClose:props.handleClose,open:Boolean(props.heading),maxWidth:\"sm\",sx:{'.MuiPaper-root':{width:\"100%\",minHeight:\"50%\"}},children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",sx:{color:theme.palette.common.primaryGreyText},children:showRejectReasons?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowRejectReasons(false),children:/*#__PURE__*/_jsx(IconFinder,{iconName:\"ArrowBack\"})}),\"Document Rejection\"]}):props.heading})}),/*#__PURE__*/_jsxs(DialogContent,{sx:{display:'flex',flexDirection:'column',gap:10},children:[/*#__PURE__*/_jsx(Stack,{flex:'auto',children:showRejectReasons?/*#__PURE__*/_jsx(InputField,{fieldName:\"selectedRejectReasons\",value:selectedRejectReasons!==null&&selectedRejectReasons!==void 0?selectedRejectReasons:'',fieldType:\"select\",fieldProps:{color:'secondary',fullWidth:true,label:'Select Reason For Rejection',required:true,options:(_GetRejectedReasonApi=GetRejectedReasonApi.data)===null||_GetRejectedReasonApi===void 0?void 0:_GetRejectedReasonApi.data.reject_reason_data.map(o=>({label:o.reject_reason,value:o.reject_reason})),sx:{'.MuiOutlinedInput-input':{paddingY:1}}},onChange:(f,v)=>setSelectedRejectReasons(v)}):props.render}),showRejectReasons?/*#__PURE__*/_jsx(Stack,{flexDirection:'row',gap:1,alignSelf:'end',children:/*#__PURE__*/_jsx(LoadingButton,{variant:\"contained\",size:\"large\",sx:{width:166},loading:props.loading||SetDocumentStatusApi.isLoading||UpdateOwnerDocumentStatusApi.isLoading,disabled:!selectedRejectReasons,onClick:rejectDocument,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",children:\"Reject\"})})}):/*#__PURE__*/_jsx(Stack,{flexDirection:'row',gap:1,alignSelf:'center',children:props.isToUpdate?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingButton,{variant:\"outlined\",size:\"large\",sx:{width:166},onClick:props.handleClose,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",sx:{color:theme.palette.common.primaryGreyText},children:props.onUpdateClick?\"Cancel\":\"Back\"})}),props.onUpdateClick&&/*#__PURE__*/_jsx(LoadingButton,{variant:\"contained\",size:\"large\",sx:{width:166},loading:props.loading||SetDocumentStatusApi.isLoading||UpdateOwnerDocumentStatusApi.isLoading,onClick:e=>{var _props$onUpdateClick;return(_props$onUpdateClick=props.onUpdateClick)===null||_props$onUpdateClick===void 0?void 0:_props$onUpdateClick.call(props,props.type,e);},children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",children:\"Update\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingButton,{variant:props.disableReject?'contained':'outlined',size:\"large\",sx:{width:166},loading:props.loading||SetDocumentStatusApi.isLoading||UpdateOwnerDocumentStatusApi.isLoading,disabled:props.disableReject,onClick:handelOnReject,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",sx:{...(!props.disableReject&&{color:theme.palette.common.primaryGreyText})},children:\"Reject\"})}),/*#__PURE__*/_jsx(LoadingButton,{variant:\"contained\",size:\"large\",sx:{width:166},loading:props.loading||SetDocumentStatusApi.isLoading||UpdateOwnerDocumentStatusApi.isLoading,disabled:props.disableAccept,onClick:handelOnAccept,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"h5\",children:\"Accept\"})})]})})]})]});};export const UpdateBankDetails=props=>{var _props$details;const theme=useTheme();const{showSnackbar,hideSnackbar}=useSnackbar();const UpdateRestaurantDetailsApi=useUpdateRestaurantDetailsApi();const[formData,setFormData]=useState((_props$details=props.details)===null||_props$details===void 0?void 0:_props$details.bank_details);const[formError,setFormError]=useState({});const onChange=(fieldName,value)=>{let _formData={};_formData={...formData,[fieldName]:value};setFormData(p=>({...p,[fieldName]:value}));setFormError({...formError,[fieldName]:validateAddDocunemtFields(fieldName,_formData)});};const handelOnUpdate=()=>{void UpdateRestaurantDetailsApi.mutateAsync({request:formData,id:props.id}).then(response=>{var _response$data7,_props$handleClose7,_props$refetch7;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data7=response.data)===null||_response$data7===void 0?void 0:_response$data7.message,onCancel:()=>hideSnackbar()});(_props$handleClose7=props.handleClose)===null||_props$handleClose7===void 0?void 0:_props$handleClose7.call(props);(_props$refetch7=props.refetch)===null||_props$refetch7===void 0?void 0:_props$refetch7.call(props);}).catch(error=>{var _error$response7,_error$response7$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.message,onCancel:()=>hideSnackbar()});});};const renderInDialog=()=>/*#__PURE__*/_jsx(Stack,{sx:{'& table':{borderCollapse:'separate',borderSpacing:\"0 4px\"},'& tr':{verticalAlign:'top'},'& .tdValue':{paddingLeft:3,'.inputField-root':{gap:0}}},children:/*#__PURE__*/_jsx(DetailsTable,{data:[{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Account Holder Name \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"res_acc_holder_name\",value:formData===null||formData===void 0?void 0:formData.res_acc_holder_name,fieldProps:{color:'secondary',fullWidth:true,error:Boolean(formError['res_acc_holder_name']),helperText:formError['res_acc_holder_name'],sx:{'.MuiOutlinedInput-input':{paddingY:1}}},onChange:onChange})}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Bank Name\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"bank_name\",value:formData===null||formData===void 0?void 0:formData.bank_name,fieldProps:{color:'secondary',fullWidth:true,error:Boolean(formError['bank_name']),helperText:formError['bank_name'],sx:{'.MuiOutlinedInput-input':{paddingY:1}}},onChange:onChange})}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Account Number \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"bank_acc_no\",value:formData===null||formData===void 0?void 0:formData.bank_acc_no,fieldProps:{color:'secondary',fullWidth:true,error:Boolean(formError['bank_acc_no']),helperText:formError['bank_acc_no'],sx:{'.MuiOutlinedInput-input':{paddingY:1}}},onChange:onChange})}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"IFSC\"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"ifsc_no\",value:formData===null||formData===void 0?void 0:formData.ifsc_no,fieldProps:{color:'secondary',fullWidth:true,error:Boolean(formError['ifsc_no']),helperText:formError['ifsc_no'],sx:{'.MuiOutlinedInput-input':{paddingY:1}}},onChange:onChange})}),showWhen:true}]})});return/*#__PURE__*/_jsx(AcceptRejectDocumentsDialog,{useApi:props.useType,id:props.id,isToUpdate:true,loading:UpdateRestaurantDetailsApi.isLoading,render:renderInDialog(),heading:'Update Bank Details',type:'Bank Details',handleClose:props.handleClose,onUpdateClick:handelOnUpdate,disableAccept:props===null||props===void 0?void 0:props.disableAccept,disableReject:props===null||props===void 0?void 0:props.disableReject});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}