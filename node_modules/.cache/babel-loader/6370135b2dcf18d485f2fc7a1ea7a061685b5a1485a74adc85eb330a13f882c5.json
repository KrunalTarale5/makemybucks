{"ast":null,"code":"/* eslint-disable indent */import{AdminCards}from'@components/Cards';import IconFinder from'@components/Icon';import InputField from'@components/InputField';import{useSnackbar}from'@components/Snackbar';import{PoppinsTypography}from'@components/Typography';import Uploader from'@components/Uploader';import{BannerInformation,useBannerInfo}from'@hooks/admin-banner-info';import{useBannerPublishApi,useBannerUnPublishApi,useGetBannerRestaurantNamesApi,useGetInitialBannersApi,validateBannerFields,validateBannerForm}from'@hooks/admin-banners';import{LoadingButton}from'@mui/lab';import{FormHelperText,Stack,useTheme}from'@mui/material';import{memo,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const intialFormData={b1_restaurant_id:'',b2_restaurant_id:'',b3_restaurant_id:'',b4_restaurant_id:'',BannerImg1:'',BannerImg2:'',BannerImg3:'',BannerImg4:''};const intialFormError={// b1_restaurant_id: '',\n// b2_restaurant_id: '',\n// b3_restaurant_id: '',\n// b4_restaurant_id: '',\nBannerImg1:'',BannerImg2:'',BannerImg3:'',BannerImg4:''};const Banner=()=>{var _GetInitialBannersApi;useBannerInfo(BannerInformation.banners);const theme=useTheme();const GetInitialBannersApi=useGetInitialBannersApi();return/*#__PURE__*/_jsxs(Stack,{gap:4,children:[/*#__PURE__*/_jsx(Stack,{children:/*#__PURE__*/_jsx(AdminCards,{heading:\"Total Banner\",content:/*#__PURE__*/_jsxs(PoppinsTypography,{variant:\"h4\",fontWeight:600,sx:{color:theme.palette.common.primaryGreyText},children:[(_GetInitialBannersApi=GetInitialBannersApi.data)===null||_GetInitialBannersApi===void 0?void 0:_GetInitialBannersApi.data.data[0].banner_count,/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText,display:'contents'},children:\"/4\"})]})})}),/*#__PURE__*/_jsx(Stack,{gap:2,flexDirection:'row',children:Array.from(Array(4).keys()).map((b,index)=>/*#__PURE__*/_jsx(BannerFields,{index:index+1},index))})]});};export default/*#__PURE__*/memo(Banner);const BannerFields=props=>{var _GetInitialBannersApi2,_GetInitialBannersApi3,_GetBnnerRestaurantNa,_ref,_formData2,_GetBnnerRestaurantNa2;const theme=useTheme();const{showSnackbar,hideSnackbar}=useSnackbar();const GetInitialBannersApi=useGetInitialBannersApi();const BannerPublishApi=useBannerPublishApi();const BannerUnPublishApi=useBannerUnPublishApi();const GetBnnerRestaurantNamesApi=useGetBannerRestaurantNamesApi();const[formData,setFormData]=useState(intialFormData);const[formError,setFormError]=useState(intialFormError);const data=(_GetInitialBannersApi2=GetInitialBannersApi.data)===null||_GetInitialBannersApi2===void 0?void 0:(_GetInitialBannersApi3=_GetInitialBannersApi2.data.data)===null||_GetInitialBannersApi3===void 0?void 0:_GetInitialBannersApi3[0];const intialBannerImg=data===null||data===void 0?void 0:data[\"banner_\".concat(props.index)];const intialRestaurantId=(_GetBnnerRestaurantNa=GetBnnerRestaurantNamesApi.data)===null||_GetBnnerRestaurantNa===void 0?void 0:_GetBnnerRestaurantNa.data.restaurant_list.find(r=>r.value===(data===null||data===void 0?void 0:data[\"b\".concat(props.index,\"_restaurant_id\")]));const intialBannerStatus=data===null||data===void 0?void 0:data[\"b\".concat(props.index,\"_publish_status\")];const onChange=(fieldName,value)=>{const _formData={...formData,[fieldName]:value};setFormData(_formData);setFormError({...formError,[fieldName]:validateBannerFields(fieldName,_formData)});};const uploadBanner=(fieldName,value)=>{BannerPublishApi.mutateAsync({request:{[fieldName]:value}}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});setFormData(intialFormData);void GetInitialBannersApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});};const publishClick=()=>{const validatation=validateBannerForm({[\"b\".concat(props.index,\"_restaurant_id\")]:formData[\"b\".concat(props.index,\"_restaurant_id\")]});if(validatation.hasError){setFormError(validatation.errors);return;}BannerPublishApi.mutateAsync({request:{...formData,[\"b\".concat(props.index,\"_publish_status\")]:'1'}}).then(response=>{var _response$data2;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.message,onCancel:()=>hideSnackbar()});setFormData(intialFormData);void GetInitialBannersApi.refetch();}).catch(error=>{var _error$response2,_error$response2$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message,onCancel:()=>hideSnackbar()});});};const unPublishClick=()=>{BannerPublishApi.mutateAsync({request:{[\"b\".concat(props.index,\"_restaurant_id\")]:null,[\"b\".concat(props.index,\"_publish_status\")]:'0'}}).then(response=>{var _response$data3;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.message,onCancel:()=>hideSnackbar()});setFormData(intialFormData);void GetInitialBannersApi.refetch();}).catch(error=>{var _error$response3,_error$response3$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message,onCancel:()=>hideSnackbar()});});};useEffect(()=>{setFormData({...formData,[\"BannerImg\".concat(props.index)]:data?intialBannerImg:'',[\"b\".concat(props.index,\"_publish_status\")]:data?intialBannerStatus:''});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[GetInitialBannersApi.dataUpdatedAt]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Stack,{gap:4,width:\"24%\",children:[/*#__PURE__*/_jsxs(Stack,{children:[/*#__PURE__*/_jsx(Uploader,{fieldName:\"BannerImg\".concat(props.index),sx:{placeContent:'flex-end',height:182,borderRadius:'20px',boxShadow:\"0px 4px 8px 0px #00000033\",justifyContent:'center',alignItems:'center'},file:(_ref=formData[\"BannerImg\".concat(props.index)])!==null&&_ref!==void 0?_ref:'',overlay:/*#__PURE__*/_jsxs(Stack,{sx:{flexDirection:'row',position:'absolute',justifyContent:'center',alignItems:'center',bottom:0,borderBottomLeftRadius:'20px',borderBottomRightRadius:'20px',backgroundColor:'#171A2099',width:'100%',height:'43px',gap:1},children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"Replace\",iconProps:{width:16,height:16}}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.white},children:\"Replace\"})]}),onChange:event=>uploadBanner(\"BannerImg\".concat(props.index),event.target.files),children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",children:\"Default Banner\"})}),formError[\"BannerImg\".concat(props.index)]&&/*#__PURE__*/_jsx(FormHelperText,{error:Boolean(formError[\"BannerImg\".concat(props.index)]),children:formError[\"BannerImg\".concat(props.index)]})]}),/*#__PURE__*/_jsxs(Stack,{children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Link to (Optional)\"}),/*#__PURE__*/_jsxs(Stack,{gap:3,children:[/*#__PURE__*/_jsx(InputField,{fieldName:\"b\".concat(props.index,\"_restaurant_id\"),value:intialRestaurantId?intialRestaurantId:(_formData2=formData[\"b\".concat(props.index,\"_restaurant_id\")])!==null&&_formData2!==void 0?_formData2:'',fieldProps:{disabled:!intialBannerImg,placeholder:'Select restaurant',// error: Boolean(\n// \tformError[`b${props.index}_restaurant_id` as keyof typeof formError]\n// ),\n// helperText: formError[`b${props.index}_restaurant_id` as keyof typeof formError],\nsize:'medium',options:(_GetBnnerRestaurantNa2=GetBnnerRestaurantNamesApi.data)===null||_GetBnnerRestaurantNa2===void 0?void 0:_GetBnnerRestaurantNa2.data.restaurant_list,sx:{'& .MuiOutlinedInput-notchedOutline':{borderColor:theme.palette.common.secondaryGreyText,borderRadius:\"8px\"},'& .MuiInputBase-input':{height:11},'& .MuiInputBase-root':{width:'100%'},'& .MuiTypography-subtitle1':{color:theme.palette.common.secondaryGreyText}}},fieldType:'select',onChange:onChange}),intialBannerStatus==='0'||intialBannerStatus===null||Boolean(formData[\"b\".concat(props.index,\"_restaurant_id\")])?/*#__PURE__*/_jsx(LoadingButton,{size:\"large\",variant:\"contained\",color:\"primary\",sx:{borderRadius:'8px',height:51},onClick:publishClick,disabled:!(intialBannerImg||Boolean(formData[\"b\".concat(props.index,\"_restaurant_id\")])),loading:BannerPublishApi.isLoading,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",children:\"Publish\"})}):/*#__PURE__*/_jsx(LoadingButton,{size:\"large\",variant:\"outlined\",color:\"primary\",sx:{borderRadius:'8px',height:51},onClick:unPublishClick,loading:BannerUnPublishApi.isLoading,children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"Un-Publish\"})})]})]})]})});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}