{"ast":null,"code":"import DetailsTable from'@components/DetailsTable';import{PoppinsTypography}from'@components/Typography';import Uploader from'@components/Uploader';import{Box,Button,Menu,MenuItem,Stack,Tab,Tabs,useTheme}from'@mui/material';import React,{memo,useEffect,useState}from'react';import OtherDetailTab from'./OtherDetailTab';import IconFinder from'@components/Icon';import{useLocation,useNavigate,useParams}from'react-router-dom';import{useChangeRestaurantStatusApi,useGetRestaurentsDetailsApi,useGetRestaurentsOtherDetailApi,useUpdateRestaurantDetailsApi,validateAddRestoFields,validateAddRestoForm}from'@hooks/admin-restaurant-management';import{useRestaurantStatus}from'@hooks/common';import{RestaurantStatus}from'@interfaces/common';import InputField from'@components/InputField';import{useSnackbar}from'@components/Snackbar';import{BannerInformation,useBannerInfo}from'@hooks/admin-banner-info';import TransactionHistoryTab from'./TransactionHistoryTab';import MenuDetailTab from'./MenuDetailTab';import moment from'moment';import{validateIsMobileNumber}from'@utils/validator';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const TABS=['Transaction history','Other Details','Menu Details'];const RestaurantDetails=()=>{var _GetRestaurentsDetail,_details$restaurant_p,_details$restaurant_n,_details$restaurant_n2,_details$restaurant_i,_formData$manager_no,_details$manager_no2,_formData$manager_nam,_details$manager_name2,_details$added_by,_details$location,_details$address;const location=useLocation();const isToUpdate=location.pathname.includes('/admin/restaurants/update/');useBannerInfo(isToUpdate?BannerInformation.restaurantManagementUpdate:BannerInformation.restaurantManagement);const theme=useTheme();const getStatus=useRestaurantStatus();const navigate=useNavigate();const{showSnackbar,hideSnackbar}=useSnackbar();const{id}=useParams();const ChangeRestaurantStatusApi=useChangeRestaurantStatusApi();const GetRestaurentsDetailsApi=useGetRestaurentsDetailsApi(id);const GetRestaurentsOtherDetailApi=useGetRestaurentsOtherDetailApi(id);const details=(_GetRestaurentsDetail=GetRestaurentsDetailsApi.data)===null||_GetRestaurentsDetail===void 0?void 0:_GetRestaurentsDetail.data.data;const UpdateRestaurantDetailsApi=useUpdateRestaurantDetailsApi();const[value,setValue]=useState(1);const[StatusAnchorEl,setStatusAnchorEl]=useState(null);const[formData,setFormData]=useState({manager_name:'',manager_no:''});const[formError,setFormError]=useState({manager_name:'',manager_no:''});const handleChange=(event,newValue)=>{setValue(newValue);};const status=getStatus(details===null||details===void 0?void 0:details.status);const handleStatusChange=status=>()=>{ChangeRestaurantStatusApi.mutateAsync({request:{restaurant_id:id,status:status.toLowerCase()}}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});void GetRestaurentsDetailsApi.refetch();setStatusAnchorEl(null);void GetRestaurentsDetailsApi.refetch();void GetRestaurentsOtherDetailApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});};const onChange=(fieldName,value,fieldType)=>{let _formData={};if(fieldType==='mobile-number'){const isNumber=validateIsMobileNumber(String(value));_formData={...formData,[fieldName]:isNumber?value:formData[fieldName]};}else{_formData={...formData,[fieldName]:value};}setFormData(_formData);setFormError({...formError,[fieldName]:validateAddRestoFields(fieldName,_formData)});};const handelOnUpdate=data=>{const validatation=validateAddRestoForm(formData);if(validatation.hasError){setFormError(validatation.errors);return;}UpdateRestaurantDetailsApi.mutateAsync({request:{...formData,...((data===null||data===void 0?void 0:data.owner_email)&&{...data})},id}).then(response=>{var _response$data2;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.message,onCancel:()=>hideSnackbar()});void GetRestaurentsDetailsApi.refetch();void GetRestaurentsOtherDetailApi.refetch();navigate(\"/admin/restaurants/\".concat(id));}).catch(error=>{var _error$response2,_error$response2$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message,onCancel:()=>hideSnackbar()});});};useEffect(()=>{var _details$manager_name,_details$manager_no;setFormData({manager_name:(_details$manager_name=details===null||details===void 0?void 0:details.manager_name)!==null&&_details$manager_name!==void 0?_details$manager_name:'',manager_no:(_details$manager_no=details===null||details===void 0?void 0:details.manager_no)!==null&&_details$manager_no!==void 0?_details$manager_no:''});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[GetRestaurentsDetailsApi.isSuccess]);const handleDisable=status=>{if(status==='5'){if((details===null||details===void 0?void 0:details.status)==='1'||(details===null||details===void 0?void 0:details.status)==='3'||(details===null||details===void 0?void 0:details.status)==='4')return true;return false;}if(status==='4'){if((details===null||details===void 0?void 0:details.status)==='5')return true;return false;}if(status==='3'){if((details===null||details===void 0?void 0:details.status)==='1'||(details===null||details===void 0?void 0:details.status)==='2')return false;}return true;};return/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:1,children:[/*#__PURE__*/_jsx(Stack,{display:'flex',sx:{background:'#F4F5F8',borderRadius:'8px',borderStyle:'solid',borderColor:'#DFE3ED',borderWidth:'1px',width:'100%',paddingBottom:3},children:/*#__PURE__*/_jsxs(Stack,{gap:5,flexDirection:'row',sx:{paddingTop:2,paddingLeft:3,paddingBottom:2},children:[/*#__PURE__*/_jsx(Uploader,{fieldName:\"fieldName\",sx:{placeContent:'flex-end',width:104,height:104,paddingTop:1,borderRadius:1},file:(_details$restaurant_p=details===null||details===void 0?void 0:details.restaurant_profile)!==null&&_details$restaurant_p!==void 0?_details$restaurant_p:'',children:/*#__PURE__*/_jsx(PoppinsTypography,{flex:'auto',alignSelf:'center',textAlign:'center',variant:\"h2\",fontWeight:600,children:details===null||details===void 0?void 0:(_details$restaurant_n=details.restaurant_name)===null||_details$restaurant_n===void 0?void 0:_details$restaurant_n.charAt(0)})}),/*#__PURE__*/_jsxs(Stack,{gap:15,flexDirection:'row',flexGrow:1,children:[/*#__PURE__*/_jsx(Stack,{sx:{width:\"25%\",'& table':{borderCollapse:'separate',borderSpacing:\"0 4px\"},'& tr':{verticalAlign:'top'},'& .tdValue':{paddingLeft:\"12px\"}},children:/*#__PURE__*/_jsx(DetailsTable,{data:[{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Name \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$restaurant_n2=details===null||details===void 0?void 0:details.restaurant_name)!==null&&_details$restaurant_n2!==void 0?_details$restaurant_n2:'')}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"ID \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$restaurant_i=details===null||details===void 0?void 0:details.restaurant_id)!==null&&_details$restaurant_i!==void 0?_details$restaurant_i:'')}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Status \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",endIcon:/*#__PURE__*/_jsx(IconFinder,{iconName:\"ChevronDown\"}),sx:{minWidth:200,justifyContent:'space-between',borderColor:theme.palette.common.secondaryGreyText,paddingY:0},onClick:e=>setStatusAnchorEl(e.currentTarget),children:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:status.sx,children:status.lable})}),/*#__PURE__*/_jsx(Menu,{anchorEl:StatusAnchorEl,open:Boolean(StatusAnchorEl),onClose:()=>setStatusAnchorEl(null),sx:{'.MuiMenu-paper':{width:StatusAnchorEl===null||StatusAnchorEl===void 0?void 0:StatusAnchorEl.getBoundingClientRect().width}},children:Object.keys(RestaurantStatus).filter(s=>s!=='0').map(s=>/*#__PURE__*/_jsx(MenuItem,{disabled:handleDisable(s),onClick:handleStatusChange(RestaurantStatus[s]),children:getStatus(s).lable},s))})]}),showWhen:true}]})}),/*#__PURE__*/_jsx(Stack,{sx:{width:\"25%\",'& table':{borderCollapse:'separate',borderSpacing:\"0 4px\"},'& tr':{verticalAlign:'top'},'& .tdValue':{paddingLeft:\"12px\"}},children:/*#__PURE__*/_jsx(DetailsTable,{data:[{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Contact No \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:isToUpdate?/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"manager_no\",value:(_formData$manager_no=formData===null||formData===void 0?void 0:formData.manager_no)!==null&&_formData$manager_no!==void 0?_formData$manager_no:'',fieldType:\"mobile-number\",fieldProps:{color:'secondary',fullWidth:true,sx:{'.MuiOutlinedInput-input':{paddingY:1},'.MuiInputBase-input':{height:15,fontSize:14}},error:Boolean(formError.manager_no),helperText:formError.manager_no},onChange:onChange}):/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$manager_no2=details===null||details===void 0?void 0:details.manager_no)!==null&&_details$manager_no2!==void 0?_details$manager_no2:'')}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Name \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:isToUpdate?/*#__PURE__*/_jsx(InputField,{showLabel:false,fieldName:\"manager_name\",value:(_formData$manager_nam=formData===null||formData===void 0?void 0:formData.manager_name)!==null&&_formData$manager_nam!==void 0?_formData$manager_nam:'',fieldProps:{color:'secondary',fullWidth:true,sx:{'.MuiOutlinedInput-input':{paddingY:1},'.MuiInputBase-input':{height:15,fontSize:14}},error:Boolean(formError.manager_name),helperText:formError.manager_name},onChange:onChange}):/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$manager_name2=details===null||details===void 0?void 0:details.manager_name)!==null&&_details$manager_name2!==void 0?_details$manager_name2:'')}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Added By  \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$added_by=details===null||details===void 0?void 0:details.added_by)!==null&&_details$added_by!==void 0?_details$added_by:'')}),showWhen:true}]})}),/*#__PURE__*/_jsx(Stack,{sx:{width:\"25%\",'& table':{borderCollapse:'separate',borderSpacing:\"0 4px\"},'& tr':{verticalAlign:'top'},'& .tdValue':{paddingLeft:\"12px\"}},children:/*#__PURE__*/_jsx(DetailsTable,{data:[{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"OBD  \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:details!==null&&details!==void 0&&details.OBD?moment(details.OBD).format('DD MMM YY'):\"--\"}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Location  \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$location=details===null||details===void 0?void 0:details.location)!==null&&_details$location!==void 0?_details$location:'')}),showWhen:true},{name:/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:\"12px\",justifyContent:'space-between',children:[/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\"Address  \"}),/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.secondaryGreyText},children:\":\"})]}),value:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:\"\".concat((_details$address=details===null||details===void 0?void 0:details.address)!==null&&_details$address!==void 0?_details$address:'')}),showWhen:true}]})})]})]})}),/*#__PURE__*/_jsx(Box,{sx:{width:'100%',padding:'8px',backgroundColor:'#E9EBF0',borderRadius:'8px'},children:/*#__PURE__*/_jsx(Tabs,{value:value,onChange:handleChange,children:TABS.map((l,index)=>/*#__PURE__*/_jsx(Tab,{sx:{minWidth:'33.3%'},label:/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:{color:theme.palette.common.primaryGreyText},children:l})},index))})}),value===0&&/*#__PURE__*/_jsx(TransactionHistoryTab,{}),value===1&&/*#__PURE__*/_jsx(OtherDetailTab,{refetch:()=>{void GetRestaurentsDetailsApi.refetch();},handelUpdateClick:handelOnUpdate}),value===2&&/*#__PURE__*/_jsx(MenuDetailTab,{})]});};export default/*#__PURE__*/memo(RestaurantDetails);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}