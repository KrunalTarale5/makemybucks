{"ast":null,"code":"import{AdminCards}from'@components/Cards';import IconFinder from'@components/Icon';import Pagination from'@components/Pagination';import Table from'@components/Table';import{PoppinsTypography}from'@components/Typography';import{useBlockUserApi,useGetUserManagementApi}from'@hooks/admin-user-management';import{useUserKycStatus,useUserStatus}from'@hooks/common';import{IconButton,Stack,TextField,useTheme}from'@mui/material';import{memo,useRef,useState}from'react';import UsersDetails from'./UsersDetails';import{useSnackbar}from'@components/Snackbar';import{useAlertDialog}from'@components/AlertDialog';import{BannerInformation,useBannerInfo}from'@hooks/admin-banner-info';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UserManagement(){var _searchInputRef$curre,_GetUserManagementApi,_GetUserManagementApi2,_GetUserManagementApi3,_GetUserManagementApi4,_ref10,_GetUserManagementApi5,_ref11,_GetUserManagementApi6;useBannerInfo(BannerInformation.userManagement);const theme=useTheme();const{showAlertDialog,hideAlertDialog}=useAlertDialog();const{showSnackbar,hideSnackbar}=useSnackbar();const getStatus=useUserStatus();const getUserKycStatus=useUserKycStatus();const BlockUserApi=useBlockUserApi();const[selectedId,setSeletedId]=useState(false);const[pageRequest,setPageRequest]=useState({page:1,size:10});const[sortRequest,setSortRequest]=useState({});const searchInputRef=useRef(null);const GetUserManagementApi=useGetUserManagementApi({...pageRequest,...sortRequest,search:(_searchInputRef$curre=searchInputRef.current)===null||_searchInputRef$curre===void 0?void 0:_searchInputRef$curre.value});const handleKeyDown=event=>{if(event.key==='Enter'){void GetUserManagementApi.refetch();}};const handlePage=page=>{setPageRequest({...pageRequest,page});};const handleDelete=row=>{showAlertDialog({title:\"\".concat(row.block_status==='0'?\"De-active \".concat(row.name):\"Enable \".concat(row.name)),content:\"Are your sure? You want to \".concat(row.block_status==='0'?\"de-active\":\"enable\",\" this user.\"),buttons:[{children:'Cancel',variant:'outlined',callback:()=>{hideAlertDialog();}},{children:row.block_status==='0'?'Yes, Deactivate':'Yes, Enable',variant:'contained',callback:()=>{BlockUserApi.mutateAsync({id:row.user_id}).then(response=>{var _response$data;showSnackbar({title:'Success!',variant:'sucess',content:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.message,onCancel:()=>hideSnackbar()});hideAlertDialog();void GetUserManagementApi.refetch();}).catch(error=>{var _error$response,_error$response$data;showSnackbar({title:'Error!',variant:'error',content:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message,onCancel:()=>hideSnackbar()});});}}]});};const rows=(_GetUserManagementApi=(_GetUserManagementApi2=GetUserManagementApi.data)===null||_GetUserManagementApi2===void 0?void 0:_GetUserManagementApi2.data.data)!==null&&_GetUserManagementApi!==void 0?_GetUserManagementApi:[];const columns=[{field:'user_id',renderHeader:()=>'UID',renderCell:_ref=>{let{row}=_ref;return row.user_id;},sortable:true},{field:'name',renderHeader:()=>\"User Name\",renderCell:_ref2=>{let{row}=_ref2;return row.name;},sortable:true},{field:'city',renderHeader:()=>\"City\",renderCell:_ref3=>{let{row}=_ref3;return row.city;},sortable:true},{field:'state',renderHeader:()=>\"State\",renderCell:_ref4=>{let{row}=_ref4;return row.state;}},{field:'total_transaction',renderHeader:()=>\"Total Transaction (\\u20B9)\",renderCell:_ref5=>{let{row}=_ref5;return row.total_transaction_amount_user;}},{field:'total_payback',renderHeader:()=>\"Total Payback (\\u20B9)\",renderCell:_ref6=>{let{row}=_ref6;return row.total_payback;}},{field:'KYC',renderHeader:()=>\"KYC\",renderCell:_ref7=>{let{row}=_ref7;const kycstatus=getUserKycStatus(row.KYC_Approval_status);return/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:kycstatus.sx,children:kycstatus.lable});},sortable:true},{field:'status',renderHeader:()=>\"Status\",renderCell:_ref8=>{let{row}=_ref8;const status=getStatus(row.block_status);return/*#__PURE__*/_jsx(PoppinsTypography,{variant:\"subtitle1\",sx:status.sx,children:status.lable});},sortable:true},{field:'action',renderHeader:()=>\"Quick Action\",renderCell:_ref9=>{let{row}=_ref9;return/*#__PURE__*/_jsxs(Stack,{flexDirection:'row',gap:1,children:[/*#__PURE__*/_jsx(IconFinder,{iconName:\"OpenEye\",iconProps:{fill:theme.palette.secondary.main,cursor:'pointer',onClick:()=>setSeletedId(row.user_id)}}),/*#__PURE__*/_jsx(IconFinder,{iconName:\"DashCircle\",iconProps:{cursor:'pointer',onClick:()=>handleDelete(row)}})]});}}];const onCancelSearch=()=>{var _searchInputRef$curre2,_searchInputRef$curre3;if((_searchInputRef$curre2=searchInputRef.current)!==null&&_searchInputRef$curre2!==void 0&&_searchInputRef$curre2.value||((_searchInputRef$curre3=searchInputRef.current)===null||_searchInputRef$curre3===void 0?void 0:_searchInputRef$curre3.value)!==''){searchInputRef.current.value='';void GetUserManagementApi.refetch();}};const handleBlockClick=value=>{searchInputRef.current.value=value;void GetUserManagementApi.refetch();};return/*#__PURE__*/_jsxs(Stack,{gap:1,flexGrow:'inherit',children:[/*#__PURE__*/_jsxs(Stack,{gap:2,flexDirection:'row',children:[/*#__PURE__*/_jsx(AdminCards,{heading:\"Total Users\",content:(_GetUserManagementApi3=GetUserManagementApi.data)===null||_GetUserManagementApi3===void 0?void 0:_GetUserManagementApi3.data.all_user_count}),/*#__PURE__*/_jsx(AdminCards,{heading:\"Active Users\",content:(_GetUserManagementApi4=GetUserManagementApi.data)===null||_GetUserManagementApi4===void 0?void 0:_GetUserManagementApi4.data.block_user_count,sx:{'.heading':{color:theme.palette.success.main}},onClick:()=>handleBlockClick('active')})]}),/*#__PURE__*/_jsx(Stack,{gap:2,flexDirection:'row',alignSelf:'self-end',children:/*#__PURE__*/_jsx(TextField,{size:\"small\",placeholder:\"Search...\",autoComplete:\"off\",InputProps:{startAdornment:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Search\"}),endAdornment:/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{padding:\"4px\"},onClick:onCancelSearch,children:/*#__PURE__*/_jsx(IconFinder,{iconName:\"Cancel\"})})},inputRef:searchInputRef,onKeyDown:handleKeyDown,sx:{'.MuiInputBase-input':{paddingLeft:1},'.MuiOutlinedInput-notchedOutline':{borderColor:'#E9ECEF'}}})}),/*#__PURE__*/_jsxs(Stack,{gap:2,flexGrow:'inherit',children:[/*#__PURE__*/_jsx(Table,{rows:rows,columns:columns,rowId:row=>row.id,tableProps:{size:'small',stickyHeader:false},tableRowProps:{hover:true},onSortChange:sort=>{setSortRequest({sort_by:sort===null||sort===void 0?void 0:sort.field,order:sort===null||sort===void 0?void 0:sort.order});},loading:GetUserManagementApi.isLoading}),/*#__PURE__*/_jsx(Pagination,{page:pageRequest.page,size:(_ref10=(_GetUserManagementApi5=GetUserManagementApi.data)===null||_GetUserManagementApi5===void 0?void 0:_GetUserManagementApi5.data.size)!==null&&_ref10!==void 0?_ref10:0,totalPages:(_ref11=(_GetUserManagementApi6=GetUserManagementApi.data)===null||_GetUserManagementApi6===void 0?void 0:_GetUserManagementApi6.data.pagesTotal)!==null&&_ref11!==void 0?_ref11:0,onPageChange:handlePage})]}),selectedId&&/*#__PURE__*/_jsx(UsersDetails,{selectedId:selectedId,onClose:()=>setSeletedId(false),refetch:()=>void GetUserManagementApi.refetch()})]});}export default/*#__PURE__*/memo(UserManagement);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}